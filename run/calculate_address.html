<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<title>Test</title>
</head>
<body>

	<input type="text" name="input" id='input'>
	<select id="select">
		<option>--Select--</option>
	</select>
	<button onclick='network_address()'>Submit</button>

	<script type="text/javascript">

		function convert(data) {

			//split address after dot
			const splitArray = data.split('.');
			if(splitArray.length < 4) {
				alert("Error");
			}

			else {
				//array for bin values
				const binArray = [];
				for(let i=0; i<splitArray.length; ++i) {
					//convert from string into int
					let intType = parseInt(splitArray[i]);
					//if conver to INT number is NaN break looop
					if(isNaN(intType)) {
						alert("Different data");
						break;
					}
					//if number isn't NaN conbert numbers to bin
					else {
						//convert numbers from dec to bin
						let bin = intType.toString(2);
						//append 0 to convert number
						let addZero = bin.padStart(8,'0');
						//append convert number to array for bin numbers
						binArray.push(addZero);
					}
				}

				let binAddress = "";
				//if bunArray length is 4 show results
				if(binArray.length == 4) {
					for(let i=0; i<binArray.length; i++) {
						if(i == binArray.length-1) {
							binAddress += binArray[i];
						}
						else {
							binAddress += binArray[i]+".";
						}

					}
					return binAddress;
				}
			}
		}

		function get_mask() {
			//select
			let select = document.querySelector("#select");
			
			//import JSON file
			let request = new Request("masks.json");
			//get data from JSON file
			fetch(request)
				//
				.then(function(resp) {
					//return JS Object
					return resp.json();
				})
				//get data from Object
				.then(function(data) {
					for(let i=1; i<=32; ++i) {
						//create option
						let option = document.createElement("option");
						//set class for option
						option.class = "option";
						//set text for option
						option.innerHTML = "/"+i+" "+data.masks[i];
						//set value
						option.value = data.masks[i];
						//and append option to select
						select.appendChild(option);
					}	
				});
			

		}

		function network_address() {
			//get input value
			let input = document.querySelector('#input').value;
			//run previous function with convert to bin
			let ipBin = convert(input);

			//get mask value from select
			let masks = document.querySelector('#select').value;
			//convert mask to bianry
			let maskBin = convert(masks);

			//network addres in binary
			let networkAddresBin = "";
			for(let i=0; i<ipBin.length; ++i) {
				//if ipBin[i] and maskBin[i] != '.'
				//append AND validation to networkAddresBin
				if(ipBin[i] != '.' && maskBin != '.') {
					networkAddresBin += (ipBin[i]&maskBin[i]);
				}
				//else ipBin[i] and maskBin[i] == '.'
				//append dot to networkAddresBin
				else if(ipBin[i] == '.' && maskBin[i] == '.') {
					networkAddresBin += '.';
				}

			}

			//split networkAddresBin
			let splitNetworkAddress = networkAddresBin.split('.');
			//var to networkAddress in dec
			let networkAddres = "";
			for(let i=0; i<splitNetworkAddress.length; ++i) {
				//convert from bin to dec
				networkAddres += parseInt(splitNetworkAddress[i], 2);
				//if i != last data from split append dot 
				//after append convert networkAddres octec 
				if(i != splitNetworkAddress.length-1) {
					networkAddres += '.';
				}
			}


			console.log(networkAddres);

		}



		get_mask();

		





	</script>

</body>
</html>